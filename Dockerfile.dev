# Development Dockerfile for Playrook application

FROM golang:1.23-alpine

# Install Node.js and npm
RUN apk add --no-cache nodejs npm

# Install air for Go hot reloading
RUN go install github.com/cosmtrek/air@latest

# Set working directory
WORKDIR /app

# Copy go mod files
COPY backend/go.mod backend/go.sum ./
RUN go mod download

# Copy air configuration
COPY backend/.air.toml ./

# Install frontend dependencies
WORKDIR /app/frontend
COPY frontend/package*.json ./
RUN npm install

# Set working directory back to root
WORKDIR /app

# Copy source code
COPY . .

# Expose ports
EXPOSE 8080 3000

# Start development servers
CMD ["sh", "-c", "cd frontend && npm run dev & cd backend && air"] 